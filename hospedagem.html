<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Busca de Experiências em Aldeias Indígenas - V5.1 com Imagens</title>
    
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css">
    <link href="https://fonts.googleapis.com/css2?family=Roboto:wght@400;700&display=swap" rel="stylesheet">
    
    <style>
        /* Cores Padrão do Menu: 
         * Principal: #8c2f1f (Marrom Escuro)
         * Secundária/Hover: #e9b384 (Bege/Ouro)
         * Fundo: #f8f5f0 (Bege Claro)
        */

        /* Estilos Globais de index.html */
        body {
            font-family: 'Roboto', Arial, sans-serif;
            margin: 0;
            padding: 0;
            background-color: #f8f5f0; /* Fundo padrão de index.html */
            color: #333;
            box-sizing: border-box;
        }

        .container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 0 20px;
        }

        .header-image {
            width: 100%;
            height: auto;
            display: block;
        }

        header {
            background-color: #8c2f1f; /* Marrom Escuro */
            padding: 15px 0;
            box-shadow: 0 2px 5px rgba(0,0,0,0.2);
        }

        header .container {
            display: flex;
            justify-content: space-between;
            align-items: center;
            flex-wrap: wrap;
        }

        .logo {
            font-size: 2em;
            font-weight: bold;
            color: #fff;
            text-decoration: none;
        }
        
        .nav-and-social {
            display: flex;
            align-items: center;
            gap: 20px; 
        }

        .menu-principal ul {
            list-style: none;
            margin: 0;
            padding: 0;
            display: flex;
        }

        .menu-principal li {
            margin-left: 20px;
        }

        .menu-principal a {
            color: #fff;
            text-decoration: none;
            font-weight: bold;
            transition: color 0.3s;
        }

        .menu-principal a:hover {
            color: #e9b384;
        }

        .social-icons-header {
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .social-icons-header a {
            color: #fff;
            font-size: 1.5em;
            transition: color 0.3s;
        }
        
        .social-icons-header a:hover {
            color: #e9b384;
        }

        .options-menu {
            display: flex;
            justify-content: center;
            align-items: center;
            padding: 20px 0;
            background-color: #f0ead6; /* Cor de fundo clara para o menu de opções */
            margin-top: 20px;
            border-radius: 10px;
            box-shadow: 0 2px 5px rgba(0,0,0,0.1);
            width: 100%;
        }

        .options-menu a {
            background-color: #8c2f1f;
            color: #fff;
            padding: 10px 20px;
            border-radius: 5px;
            text-decoration: none;
            margin: 0 10px;
            font-weight: bold;
            transition: background-color 0.3s;
        }

        .options-menu a:hover {
            background-color: #6a2419;
        }

        .chatbot-button {
            display: flex;
            align-items: center;
            gap: 8px;
            cursor: pointer;
        }
        
        .chatbot-gif-icon {
            width: 25px;
            height: 25px;
            border-radius: 50%;
        }

        main {
            padding: 40px 0;
            text-align: center;
        }
        
        main h1 {
            color: #8c2f1f; 
            margin-bottom: 20px;
        }

        /* Rodapé de index.html */
        footer {
            background-color: #6a2419;
            color: #fff;
            padding: 20px 0;
            text-align: center;
            width: 100%;
        }

        .social-icons {
            margin-bottom: 10px;
        }

        .social-icons a {
            color: white;
            font-size: 1.5em;
            margin: 0 10px;
            text-decoration: none;
        }

        .social-icons a:hover {
            color: #e5ccae;
        }

        .copyright {
            margin-top: 10px;
        }
        
        /* Estilos do Pop-up (Chatbot) de index.html */
        .popup-container {
            display: none; 
            position: fixed;
            z-index: 1001;
            left: 0;
            top: 0;
            width: 100%;
            height: 100%;
            overflow: auto;
            background-color: rgba(0,0,0,0.4); 
            justify-content: center;
            align-items: center;
        }

        .popup-content {
            background-color: #fefefe;
            margin: auto;
            padding: 20px;
            border: 1px solid #888;
            width: 80%;
            max-width: 400px;
            border-radius: 10px;
            box-shadow: 0 5px 15px rgba(0,0,0,0.3);
            text-align: center;
        }

        .close-btn {
            color: #aaa;
            float: right;
            font-size: 28px;
            font-weight: bold;
        }

        .close-btn:hover,
        .close-btn:focus {
            color: #000;
            text-decoration: none;
            cursor: pointer;
        }

        .popup-content a {
            display: inline-block;
            margin-top: 15px;
            background-color: #8c2f1f;
            color: white;
            padding: 10px 20px;
            text-decoration: none;
            border-radius: 5px;
            font-weight: bold;
        }

        /* Estilos Únicos de Hospedagem.html (Ajustados ao Padrão de Cores) */
        
        .filter-content-container {
            max-width: 900px;
            margin: auto;
            background: white;
            padding: 30px;
            border-radius: 10px;
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.15);
            background-color: #f8f5f0; 
        }

        .filter-grid {
            display: grid;
            grid-template-columns: repeat(5, 1fr); 
            gap: 15px;
            padding: 20px;
            border: 1px solid #e9b384; 
            border-radius: 8px;
            margin-bottom: 20px;
            background-color: #fcfcfc; 
        }
        
        input[type="date"], input[type="number"], input[type="text"] {
            width: 100%;
            padding: 8px;
            border: 1px solid #ccc;
            border-radius: 5px;
            box-sizing: border-box; 
        }
        
        button {
            width: 100%;
            padding: 12px;
            background-color: #8c2f1f; 
            color: white;
            cursor: pointer;
            font-weight: bold;
            border: none;
            border-radius: 5px;
            transition: background-color 0.3s ease;
            grid-column: 1 / -1; 
            margin-top: 10px;
        }
        button:hover {
            background-color: #6a2419; 
        }
        
        /* Resultados */
        #resultado {
            margin-top: 30px;
            padding: 20px;
            border-radius: 5px;
            border-left: 5px solid #8c2f1f; 
            background-color: #f0ead6; 
            min-height: 100px;
            text-align: left;
        }
        #resultado h2 {
            margin-top: 0;
            color: #8c2f1f; 
        }
        .pousada-info {
            display: flex;
            align-items: flex-start;
            margin-bottom: 15px;
            padding: 10px;
            border: 1px solid #ddd;
            border-radius: 5px;
            background-color: white;
            gap: 15px;
        }
        
        /* === INÍCIO DA ALTERAÇÃO: Estilo da Imagem (Padrão a01.jpeg) === */
        .pousada-info img {
            width: 150px;           /* Largura fixa para manter o layout organizado */
            height: 100px;          /* Altura fixa */
            object-fit: cover;      /* Garante que a imagem preencha a área sem distorcer */
            border-radius: 4px;     /* Bordas levemente arredondadas */
            cursor: pointer;        /* Indica que a imagem é clicável (Lightbox) */
            transition: opacity 0.3s;
        }
        
        .pousada-info img:hover {
            opacity: 0.85; /* Efeito suave ao passar o mouse */
        }
        /* === FIM DA ALTERAÇÃO === */

        /* Estilo para o nome da aldeia clicável */
        .pousada-info h3 {
             margin-top: 0;
             color: #8c2f1f; 
             cursor: pointer; /* Indica que é clicável */
             text-decoration: underline; /* Ajuda a indicar que é um link/botão */
        }
        .pousada-info h3:hover {
             color: #6a2419;
        }
        
        /* Cores de status de disponibilidade */
        .disponivel {
            color: #007bff; 
            font-weight: bold;
        }
        .indisponivel {
            color: red; 
            font-weight: bold;
        }

        /* Modal (Lightbox) Padrão para Imagens e Mapas */
        .modal {
            display: none;
            position: fixed;
            z-index: 1002;
            padding-top: 50px; /* Reduzido para dar espaço ao mapa */
            left: 0;
            top: 0;
            width: 100%; 
            height: 100%; 
            overflow: auto;
            background-color: rgb(0,0,0);
            background-color: rgba(0,0,0,0.9);
            justify-content: center;
            align-items: center;
        }

        .modal-content {
            margin: auto;
            display: block;
            width: 90%;
            max-width: 800px; /* Aumentado para o mapa */
            height: auto;
            animation-name: zoom;
            animation-duration: 0.6s;
        }
        
        /* Estilo específico para o iframe do mapa */
        .map-iframe {
            width: 100%;
            height: 500px; /* Altura fixa para o mapa */
            border: none;
            border-radius: 8px;
        }

        .close {
            position: absolute;
            top: 15px;
            right: 35px;
            color: #f1f1f1;
            font-size: 40px;
            font-weight: bold;
            transition: 0.3s;
        }

        .close:hover,
        .close:focus {
            color: #bbb;
            text-decoration: none;
            cursor: pointer;
        }
        
        @keyframes zoom {
            from {transform:scale(0)} 
            to {transform:scale(1)}
        }
    </style>
</head>
<body>
    <audio id="background-audio" loop autoplay>
        <source src="Nhanerãmoi'i Karai Poty - Memória Viva Guarani (youtube).mp3" type="audio/mpeg">
        Seu navegador não suporta a tag de áudio.
    </audio>

    <img src="FAIXA4_BRANCA.png" alt="Padrão cultural Guarani" class="header-image">

    <header>
        <div class="container">
            <a href="index.html" class="logo">Nhandereko</a>
            <div class="nav-and-social">
                <nav class="menu-principal">
                    <ul>
                        <li><a href="index.html">Início</a></li>
                        <li><a href="cadastro.html">Cadastro</a></li>
                        <li><a href="sobre.html">Sobre</a></li>
                        <li><a href="faleconosco.html">Fale Conosco</a></li>
                        <li><a href="etnoturismo.html">Etnoturismo</a></li>
                        <li><a href="galeria.html">Galeria de Fotos</a></li>
                        <li><a href="volunturismo.html">Volunturismo</a></li>
                    </ul>
                </nav>
                <div class="social-icons-header">
                    <a href="#" target="_blank" aria-label="YouTube"><i class="fab fa-youtube"></i></a>
                    <a href="#" target="_blank" aria-label="Facebook"><i class="fab fa-facebook"></i></a>
                    <a href="#" target="_blank" aria-label="Instagram"><i class="fab fa-instagram"></i></a>
                </div>
            </div>
        </div>
    </header>

    <div class="options-menu">
        <a href="hospedagem.html" class="option-button">Visitações</a>
        <a href="passeios.html" class="option-button">Passeios</a>
        <a href="artesanatos.html" class="option-button">Artesanatos</a>
    </div>

    <main>
        <div class="filter-content-container">
            <h1>Busca de Experiências em Aldeias Indígenas</h1>
            <h3>Clique com o mouse sobre o nome da Aldeia para abrir o Google Maps</h3>

            <div class="filter-grid">
                
                <div class="form-group">
                    <label>Cidade/UF mais próxima:</label>
                    <div class="input-inline">
                        <input type="text" id="cidade" placeholder="Cidade">
                        <input type="text" id="uf" maxlength="2" placeholder="UF">
                    </div>
                </div>

                <div class="form-group">
                    <label>Custo Diário (R$):</label>
                    <div class="input-inline">
                        <input type="number" id="valorMinimo" placeholder="0" value="0" min="0">
                        <input type="number" id="valorMaximo" placeholder="1000" value="1000" min="0">
                    </div>
                </div>

                <div class="form-group">
                    <label for="numQuartos">Mín. Ocas/Malocas:</label>
                    <input type="number" id="numQuartos" placeholder="Ex: 1" min="1">
                </div>

                <div class="form-group">
                    <label for="nomePousada">Nome da Aldeia (Busca Parcial):</label>
                    <input type="text" id="nomePousada" placeholder="Ex: Pataxó">
                </div>

                <div class="form-group">
                    <label>Início/Fim da Visita:</label>
                    <input type="date" id="checkin" title="Início da Visita">
                    <input type="date" id="checkout" title="Fim da Visita" style="margin-top: 5px;">
                </div>

                <button onclick="aplicarFiltros()">Buscar Aldeias</button>
            </div>

            <hr>

            <div id="resultado">
                <h2>Resultados da Busca</h2>
                <p>Preencha os filtros para encontrar a melhor experiência de vivência indígena.</p>
            </div>
        </div>
    </main>
    
    <div id="imageModal" class="modal" onclick="closeModal()">
        <span class="close" onclick="closeModal(event)">×</span> 
        <img class="modal-content" id="img01">
    </div>
    
    <div id="mapModal" class="modal" onclick="closeModal(event)">
        <span class="close" onclick="closeModal(event)">×</span>
        <div class="modal-content" id="map-content">
            <h2 style="color:white; text-align:center;">Localização Aproximada</h2>
            <div id="map-container"></div>
        </div>
    </div>


    <div id="popup" class="popup-container">
        <div class="popup-content">
            <span class="close-btn" id="close-popup">×</span>
            <h2>Nhandereko Bot</h2>
            <p>Para interagir com o nosso bot no Telegram, clique no botão abaixo.</p>
            <a href="https://t.me/nhanderebot" target="_blank">Conversar com o Bot</a>
        </div>
    </div>

    <footer>
        <div class="container">
            <div class="social-icons footer-icons">
                <a href="#" target="_blank" aria-label="YouTube"><i class="fab fa-youtube"></i></a>
                <a href="#" target="_blank" aria-label="Facebook"><i class="fab fa-facebook"></i></a>
                <a href="#" target="_blank" aria-label="Instagram"><i class="fab fa-instagram"></i></a>
                <a href="https://t.me/nhanderebot" target="_blank" aria-label="Telegram"><i class="fab fa-telegram"></i></a>
            </div>
            
            <p class="copyright">© 2024 Nhandereko. Todos os direitos reservados.</p>
        </div>
    </footer>

    <script>
        // --- FUNÇÕES DOS MODAIS ---

        // Função para fechar os modais
        function closeModal(event) {
            // Verifica se o evento é um clique fora do conteúdo ou no botão de fechar
            if (event && event.target.classList.contains('modal')) {
                document.getElementById("imageModal").style.display = "none";
                document.getElementById("mapModal").style.display = "none";
            } else if (event && event.target.classList.contains('close')) {
                document.getElementById("imageModal").style.display = "none";
                document.getElementById("mapModal").style.display = "none";
            }
        }
        
        // Função para abrir o modal da imagem
        function openImageModal(imgSrc) {
            const modal = document.getElementById("imageModal");
            const modalImg = document.getElementById("img01");
            
            modal.style.display = "flex";
            modalImg.src = imgSrc;
        }
        
        // Função NOVA: Abre o modal do Google Maps
        function showLocationMap(pousadaId) {
            const pousada = pousadas[pousadaId];
            if (!pousada) return;

            const mapModal = document.getElementById("mapModal");
            const mapContainer = document.getElementById("map-container");

            // Limpa o conteúdo anterior
            mapContainer.innerHTML = '';
            
            // Texto de busca focado na cidade e estado
            const query = `Aldeia Indígena ${pousada.nome} ${pousada.cidade} ${pousada.uf}`;
            
            // URL do iframe do Google Maps (usa o embed e a query)
            // A Aldeia Indígena é adicionada para tentar refinar a busca
            const mapUrl = `https://maps.google.com/maps?q=${encodeURIComponent(query)}&z=10&output=embed`;

            const iframe = document.createElement('iframe');
            iframe.src = mapUrl;
            iframe.className = 'map-iframe';
            iframe.allowFullscreen = true;
            iframe.loading = "lazy";
            iframe.title = `Localização da ${pousada.nome} no Google Maps`;
            
            mapContainer.appendChild(iframe);
            mapModal.style.display = "flex";
        }


        // --- BANCO DE DADOS SIMULADO ---
        const pousadas = { 
            // --- ALDEIAS ORIGINAIS (1 RJ, 1 BA, 1 PE, 1 AM) ---
            'guarani': {
                id: 'guarani',
                nome: "Aldeia Tekoa Jataí (Guarani)",
                descricao: "Vivência cultural próxima à Mata Atlântica. Artesanato e ocas coletivas.",
                valorDiaria: 180, cidade: "Paraty", uf: "RJ", numQuartos: 3, 
                indisponivel: ['2025-12-24', '2025-12-25', '2026-01-01', '2026-01-02'],
                imagemUrl: "a01.jpeg" 
            },
            'pataxo': {
                id: 'pataxo',
                nome: "Aldeia Barra Velha (Pataxó)",
                descricao: "Turismo de base comunitária na Costa do Descobrimento. Foco em culinária e danças.",
                valorDiaria: 250, cidade: "Porto Seguro", uf: "BA", numQuartos: 2, 
                indisponivel: ['2025-11-15', '2025-11-16', '2025-11-17'],
                imagemUrl: "a02.jpeg" 
            },
            'chapeu': {
                id: 'chapeu',
                nome: "Aldeia Chapéu de Palha (Fulni-ô)",
                descricao: "Foco em rituais e línguas nativas. Recomenda-se estadias longas.",
                valorDiaria: 100, cidade: "Águas Belas", uf: "PE", numQuartos: 4, 
                indisponivel: [],
                imagemUrl: "a03.jpeg" 
            },
            'yanomami': {
                id: 'yanomami',
                nome: "Comunidade Watorikɨ (Yanomami)",
                descricao: "Imersão profunda na floresta amazônica. Requer logística e autorização prévia.",
                valorDiaria: 400, cidade: "São Gabriel da Cachoeira", uf: "AM", numQuartos: 1, 
                indisponivel: ['2025-10-10', '2025-10-11'],
                imagemUrl: "a04.jpeg" 
            },
            // --- ALDEIAS DE SÃO PAULO (LITORAL E CAPITAL) ---
            'krukutu': {
                id: 'krukutu',
                nome: "Aldeia Krukutu (Guarani Mbya)",
                descricao: "Zona sul de São Paulo, próxima à represa Billings. Foco em trilhas e ecoturismo.",
                valorDiaria: 160, cidade: "São Paulo", uf: "SP", numQuartos: 3, 
                indisponivel: ['2025-12-01', '2025-12-02', '2025-12-03'],
                imagemUrl: "a05.jpeg" 
            },
            // --- NOVAS ALDEIAS ADICIONADAS DO DOCUMENTO PDF (LITORAL SP) ---
            'sp_tangara': {
                id: 'sp_tangara',
                nome: "Aldeia Tangará",
                descricao: "Vivência Guarani Mbya na região de Itanhaém, com foco em tradições da Mata Atlântica e artesanato.",
                valorDiaria: 165, cidade: "Itanhaém", uf: "SP", numQuartos: 3, 
                indisponivel: ['2025-11-20'],
                imagemUrl: "a26.jpeg" 
            },
            'sp_piacaguera': {
                id: 'sp_piacaguera',
                nome: "Sítio Piaçaguera (Peruíbe)",
                descricao: "Sítio Guarani que abrange diversas aldeias (Tanigwá, Tabaçu, etc.). Local de forte concentração cultural e rituais.",
                valorDiaria: 220, cidade: "Peruíbe", uf: "SP", numQuartos: 5, 
                indisponivel: ['2025-12-24', '2025-12-25'],
                imagemUrl: "a27.jpeg" 
            },
            'sp_tekoa_mirim': {
                id: 'sp_tekoa_mirim',
                nome: "Aldeia Tekoa Mirim",
                descricao: "Comunidade Guarani Mbya na Serra do Mar em Praia Grande. Ideal para trilhas e ecoturismo.",
                valorDiaria: 180, cidade: "Praia Grande", uf: "SP", numQuartos: 2, 
                indisponivel: ['2026-01-01'],
                imagemUrl: "a28.jpeg" 
            },
            'sp_rio_branco': {
                id: 'sp_rio_branco',
                nome: "Aldeia Rio Branco",
                descricao: "Aldeia em área de difícil localização em Itanhaém (Emburá), com foco em preservação ambiental e recursos hídricos.",
                valorDiaria: 130, cidade: "Itanhaém", uf: "SP", numQuartos: 3, 
                indisponivel: [],
                imagemUrl: "a29.jpeg" 
            },
            'sp_itaoca': {
                id: 'sp_itaoca',
                nome: "Aldeia Itaoca",
                descricao: "Comunidade em Mongaguá, com forte presença em atividades de educação e cultura local.",
                valorDiaria: 175, cidade: "Mongaguá", uf: "SP", numQuartos: 4, 
                indisponivel: ['2025-11-05', '2025-11-06'],
                imagemUrl: "a30.jpeg" 
            },
            'sp_aguapeu': {
                id: 'sp_aguapeu',
                nome: "Aldeia Aguapeú",
                descricao: "Localizada em Mongaguá (Vila Vera Cruz). Foco em agricultura familiar e produção artesanal.",
                valorDiaria: 150, cidade: "Mongaguá", uf: "SP", numQuartos: 2, 
                indisponivel: [],
                imagemUrl: "a31.jpeg" 
            },
            'sp_paranapua': {
                id: 'sp_paranapua',
                nome: "Aldeia Paranapuã",
                descricao: "Aldeia próxima ao Parque Prainha em São Vicente. Foco em história, lendas e conexão com o mar.",
                valorDiaria: 195, cidade: "São Vicente", uf: "SP", numQuartos: 3, 
                indisponivel: ['2026-02-01'],
                imagemUrl: "a32.jpeg" 
            },
            'sp_bananal': {
                id: 'sp_bananal',
                nome: "Aldeia Bananal",
                descricao: "Comunidade Guarani na região de Peruíbe, conhecida por suas tradições de pesca, caça e manejo de plantas nativas.",
                valorDiaria: 185, cidade: "Peruíbe", uf: "SP", numQuartos: 2, 
                indisponivel: ['2025-10-15', '2025-10-16'],
                imagemUrl: "a33.jpeg" 
            },
            'sp_rio_silveira': {
                id: 'sp_rio_silveira',
                nome: "Aldeia Rio Silveira",
                descricao: "Uma das maiores aldeias do litoral de SP (Bertioga). Forte em eventos culturais, exposições e turismo de longa data.",
                valorDiaria: 210, cidade: "Bertioga", uf: "SP", numQuartos: 5, 
                indisponivel: ['2026-01-26', '2026-01-27'],
                imagemUrl: "a34.jpeg" 
            },
            // --- ALDEIAS GUARANI - RS, SC, PR, MS, RJ, ES, PA (19) ---
            'rs_nhu_poti': {
                id: 'rs_nhu_poti',
                nome: "Aldeia Nhu Poti (Guarani)",
                descricao: "Litoral norte gaúcho. Foco em produção de cestaria e agricultura.",
                valorDiaria: 160, cidade: "Torres", uf: "RS", numQuartos: 3, indisponivel: ['2026-02-05'],
                imagemUrl: "a06.jpeg" 
            },
            'rs_canta_galo': {
                id: 'rs_canta_galo',
                nome: "Aldeia Canta Galo (Guarani Mbya)",
                descricao: "Próximo à cidade. Vivência urbana e rural.",
                valorDiaria: 120, cidade: "Porto Alegre", uf: "RS", numQuartos: 2, indisponivel: ['2026-01-01'],
                imagemUrl: "a07.jpeg" 
            },
            'rs_potrero': {
                id: 'rs_potrero',
                nome: "Aldeia Potrero (Guarani)",
                descricao: "Comunidade tradicional com foco em rituais e cantos.",
                valorDiaria: 210, cidade: "Tenente Portela", uf: "RS", numQuartos: 4, indisponivel: [],
                imagemUrl: "a08.jpeg" 
            },
            'rs_solidao': {
                id: 'rs_solidao',
                nome: "Aldeia Solidão (Guarani)",
                descricao: "Isolada, ideal para quem busca imersão na natureza.",
                valorDiaria: 190, cidade: "São Leopoldo", uf: "RS", numQuartos: 2, indisponivel: ['2025-11-01'],
                imagemUrl: "a09.jpeg" 
            },
            'rs_arvorezinha': {
                id: 'rs_arvorezinha',
                nome: "Aldeia Arvorezinha (Guarani Mbya)",
                descricao: "Localizada em região de floresta densa.",
                valorDiaria: 170, cidade: "Canoas", uf: "RS", numQuartos: 3, indisponivel: [],
                imagemUrl: "a10.jpeg" 
            },
            'sc_morro_dos_caios': {
                id: 'sc_morro_dos_caios',
                nome: "Aldeia Morro dos Caídos (Guarani)",
                descricao: "Com vista para o mar. Próxima a Florianópolis.",
                valorDiaria: 280, cidade: "Palhoça", uf: "SC", numQuartos: 3, indisponivel: ['2025-12-25'],
                imagemUrl: "a11.jpeg" 
            },
            'sc_guarani_litoral': {
                id: 'sc_guarani_litoral',
                nome: "Aldeia Tekoá Mirim (Guarani)",
                descricao: "No litoral catarinense, foco em culinária local.",
                valorDiaria: 200, cidade: "Imbituba", uf: "SC", numQuartos: 2, indisponivel: [],
                imagemUrl: "a12.jpeg" 
            },
            'sc_xanxere': {
                id: 'sc_xanxere',
                nome: "Aldeia Tekoá Marangatu (Guarani)",
                descricao: "No oeste do estado, rica em tradições e rituais.",
                valorDiaria: 145, cidade: "Xanxerê", uf: "SC", numQuartos: 5, indisponivel: ['2025-10-20'],
                imagemUrl: "a13.jpeg" 
            },
            'sc_litoral_norte': {
                id: 'sc_litoral_norte',
                nome: "Aldeia Yvy Katu (Guarani)",
                descricao: "Próxima a praias populares.",
                valorDiaria: 230, cidade: "Balneário Camboriú", uf: "SC", numQuartos: 2, indisponivel: [],
                imagemUrl: "a14.jpeg" 
            },
            'pr_caminho_do_peabiru': {
                id: 'pr_caminho_do_peabiru',
                nome: "Aldeia Araçaí (Guarani)",
                descricao: "No interior do Paraná, ligada ao Caminho do Peabiru.",
                valorDiaria: 170, cidade: "Piraquara", uf: "PR", numQuartos: 4, indisponivel: ['2025-11-10'],
                imagemUrl: "a15.jpeg" 
            },
            'pr_litoral': {
                id: 'pr_litoral',
                nome: "Aldeia Tekoá Jakupé (Guarani)",
                descricao: "Localizada no litoral paranaense.",
                valorDiaria: 190, cidade: "Paranaguá", uf: "PR", numQuartos: 3, indisponivel: [],
                imagemUrl: "a16.jpeg" 
            },
            'pr_curitiba': {
                id: 'pr_curitiba',
                nome: "Aldeia Kakané Porã (Guarani)",
                descricao: "Comunidade próxima à capital, com forte intercâmbio cultural.",
                valorDiaria: 155, cidade: "Curitiba", uf: "PR", numQuartos: 2, indisponivel: ['2025-12-05'],
                imagemUrl: "a17.jpeg" 
            },
            'ms_kaiowa_reserva': {
                id: 'ms_kaiowa_reserva',
                nome: "Aldeia Tey'ikue (Guarani Kaiowá)",
                descricao: "No sul do estado. Foco em desafios territoriais e preservação cultural.",
                valorDiaria: 135, cidade: "Caarapó", uf: "MS", numQuartos: 5, indisponivel: [],
                imagemUrl: "a18.jpeg" 
            },
            'ms_guarani_fronteira': {
                id: 'ms_guarani_fronteira',
                nome: "Aldeia Ñande Ru (Guarani)",
                descricao: "Comunidade próxima à fronteira com o Paraguai.",
                valorDiaria: 110, cidade: "Coronel Sapucaia", uf: "MS", numQuartos: 3, indisponivel: ['2026-01-20'],
                imagemUrl: "a19.jpeg" 
            },
            'ms_dourados': {
                id: 'ms_dourados',
                nome: "Aldeia Bororó (Guarani Kaiowá)",
                descricao: "Localizada na região de Dourados, grande concentração populacional.",
                valorDiaria: 145, cidade: "Dourados", uf: "MS", numQuartos: 4, indisponivel: [],
                imagemUrl: "a20.jpeg" 
            },
            'rj_tapema': {
                id: 'rj_tapema',
                nome: "Aldeia Tekoá Tapema (Guarani)",
                descricao: "Litoral carioca, próxima à Restinga de Marambaia.",
                valorDiaria: 250, cidade: "Guaratiba", uf: "RJ", numQuartos: 2, indisponivel: ['2025-11-25'],
                imagemUrl: "a21.jpeg" 
            },
            'rj_serra': {
                id: 'rj_serra',
                nome: "Aldeia Mata Verde (Guarani)",
                descricao: "Região serrana do estado. Foco em plantas medicinais.",
                valorDiaria: 175, cidade: "Caxias", uf: "RJ", numQuartos: 3, indisponivel: [],
                imagemUrl: "a22.jpeg" 
            },
            'es_litoral': {
                id: 'es_litoral',
                nome: "Aldeia Boa Esperança (Guarani)",
                descricao: "Próxima à Reserva de Comboios. Atividades de preservação marinha.",
                valorDiaria: 195, cidade: "Conceição da Barra", uf: "ES", numQuartos: 2, indisponivel: ['2025-12-15'],
                imagemUrl: "a23.jpeg" 
            },
            'es_serra': {
                id: 'es_serra',
                nome: "Aldeia Caieiras Velhas (Guarani)",
                descricao: "Região de serra capixaba, com clima mais ameno.",
                valorDiaria: 160, cidade: "Vitória", uf: "ES", numQuartos: 3, indisponivel: [],
                imagemUrl: "a24.jpeg" 
            },
            'pa_tapajos': {
                id: 'pa_tapajos',
                nome: "Aldeia Rio Tapajós (Guarani)",
                descricao: "Comunidade na bacia do Tapajós, com influência ribeirinha.",
                valorDiaria: 215, cidade: "Santarém", uf: "PA", numQuartos: 3, indisponivel: [],
                imagemUrl: "a25.jpeg" 
            }
        };

        // --- FUNÇÃO DE FILTRAGEM ---

        function aplicarFiltros() {
            // 1. Obter e tratar os valores dos filtros
            const cidade = document.getElementById('cidade').value.trim().toLowerCase();
            const uf = document.getElementById('uf').value.trim().toUpperCase();
            
            const valorMinimo = parseFloat(document.getElementById('valorMinimo').value) || 0;
            const valorMaximo = parseFloat(document.getElementById('valorMaximo').value) || Infinity;
            const numQuartosMin = parseInt(document.getElementById('numQuartos').value) || 0;
            const nomePousada = document.getElementById('nomePousada').value.trim().toLowerCase();
            
            // 2. Aplicar a lógica de filtragem
            const resultados = Object.values(pousadas).filter(pousada => {
                const cidadeMatch = !cidade || pousada.cidade.toLowerCase().includes(cidade);
                const ufMatch = !uf || pousada.uf.toUpperCase() === uf;
                const valorMatch = pousada.valorDiaria >= valorMinimo && pousada.valorDiaria <= valorMaximo;
                const quartosMatch = pousada.numQuartos >= numQuartosMin;
                const nomeMatch = !nomePousada || pousada.nome.toLowerCase().includes(nomePousada);
                const disponibilidadeMatch = true; 

                return cidadeMatch && ufMatch && valorMatch && quartosMatch && nomeMatch && disponibilidadeMatch;
            });

            // 3. Exibir resultados
            const resultadoDiv = document.getElementById('resultado');
            resultadoDiv.innerHTML = '<h2>Resultados da Busca</h2>';


            if (resultados.length === 0) {
                resultadoDiv.innerHTML += '<p>Nenhuma aldeia encontrada com os filtros especificados.</p>';
            } else {
                resultados.forEach(pousada => {
                    const isDisponivel = pousada.indisponivel.length === 0 ? true : false; 
                    const status = isDisponivel ? '<span class="disponivel">Disponível</span>' : '<span class="indisponivel">Indisponível em datas chave</span>';

                    // A chamada da função showLocationMap(pousada.id) é adicionada ao evento onclick do <h3>
                    resultadoDiv.innerHTML += `
                        <div class="pousada-info">
                            <img src="${pousada.imagemUrl}" 
                                 alt="Imagem da ${pousada.nome}"
                                 onclick="openImageModal(this.src)">
                            <div class="pousada-details">
                                <h3 onclick="showLocationMap('${pousada.id}')">${pousada.nome}</h3>
                                <p><strong>Local:</strong> ${pousada.cidade} - ${pousada.uf}</p>
                                <p><strong>Diária Média:</strong> R$ ${pousada.valorDiaria.toFixed(2).replace('.', ',')}</p>
                                <p><strong>Ocas/Malocas Disponíveis:</strong> ${pousada.numQuartos}</p>
                                <p><strong>Status:</strong> ${status}</p>
                                <p>${pousada.descricao}</p>
                            </div>
                        </div>
                    `;
                });
            }
        }

        // Função auxiliar para formatar a data de hoje para o padrão 'YYYY-MM-DD'
        function getTodayDateFormatted() {
            const today = new Date();
            const year = today.getFullYear();
            const month = String(today.getMonth() + 1).padStart(2, '0');
            const day = String(today.getDate()).padStart(2, '0');
            return `${year}-${month}-${day}`;
        }
        
        // --- INICIALIZAÇÃO ---
        document.addEventListener('DOMContentLoaded', () => {
            // 1. Configura a data atual
            const today = getTodayDateFormatted();
            document.getElementById('checkin').value = today;
            document.getElementById('checkout').value = today;

            // 2. Configura o chatbot
            const chatbotGif = document.getElementById('chatbot-gif'); 
            const popup = document.getElementById('popup');
            const closeBtn = document.getElementById('close-popup');

            if (chatbotGif && popup && closeBtn) {
                chatbotGif.addEventListener('click', (e) => {
                    e.preventDefault(); 
                    popup.style.display = 'flex';
                });

                closeBtn.addEventListener('click', () => {
                    popup.style.display = 'none';
                });

                // Reutiliza closeModal para o popup do chatbot (melhoria)
                window.addEventListener('click', (event) => {
                    if (event.target === popup) {
                        popup.style.display = 'none';
                    }
                });
            }

            // 3. Aplica os filtros iniciais
            aplicarFiltros();
        });
    </script>
</body>
</html>